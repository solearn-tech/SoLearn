import React from 'react';
import Image from 'next/image';
import Link from 'next/link';
import { FiDownload, FiExternalLink, FiShare2, FiCheck } from 'react-icons/fi';

// Chinese comment replaced with English comment
export interface CertificateCardProps {
  id: string;
  title: string;
  courseName: string;
  courseId: string;
  imageUrl: string;
  issueDate: Date;
  tokenId?: string;
  transactionId?: string;
  skills: string[];
  issuer: {
    name: string;
    logo: string;
  };
  isNFT: boolean;
  isVerified: boolean;
}

// Chinese comment replaced with English comment
const CertificateCard = ({
  id,
  title,
  courseName,
  courseId,
  imageUrl,
  issueDate,
  tokenId,
  transactionId,
  skills,
  issuer,
  isNFT,
  isVerified
}) => {
  // Chinese comment replaced with English comment
  const formatDate = (date: Date) => {
    return date.toLocaleDateString('zh-CN', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  };

  // Chinese comment replaced with English comment
  const handleShare = () => {
    // Chinese comment replaced with English comment
    const shareUrl = `${window.location.origin}/certificate/${id}`;
    
    // Chinese comment replaced with English comment
    navigator.clipboard.writeText(shareUrl);
    
    // Chinese comment replaced with English comment
    alert('证书链接已复制到剪贴板');
  };

  // Chinese comment replaced with English comment
  const handleDownload = () => {
    // Chinese comment replaced with English comment
    alert('开始Download证书...');
  };

  // Chinese comment replaced with English comment
  const viewOnBlockchain = () => {
    if (!transactionId) return;
    
    // Chinese comment replaced with English comment
    window.open(`https://explorer.solana.com/tx/${transactionId}`, '_blank');
  };

  return (
    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-md transition-shadow">
      {/* 证书图片预览 */}
      <div className="aspect-[4/3] relative bg-gray-100 dark:bg-gray-900">
        {imageUrl ? (
          <Image
            src={imageUrl}
            alt={title}
            layout="fill"
            objectFit="cover"
          />
        ) : (
          <div className="absolute inset-0 flex items-center justify-center">
            <div className="text-gray-400 dark:text-gray-600 text-lg">证书预览不可用</div>
          </div>
        )}
        
        {/* NFT 标识 */}
        {isNFT && (
          <div className="absolute top-2 right-2 bg-primary-600 text-white text-xs px-2 py-1 rounded-full">
            NFT
          </div>
        )}
        
        {/* 已验证标识 */}
        {isVerified && (
          <div className="absolute top-2 left-2 bg-green-600 text-white text-xs px-2 py-1 rounded-full flex items-center">
            <FiCheck className="mr-1" size={12} />
            已验证
          </div>
        )}
      </div>
      
      {/* 证书Content */}
      <div className="p-4">
        <h3 className="font-bold text-gray-900 dark:text-white text-lg mb-1">{title}</h3>
        
        <Link href={`/courses/${courseId}`}>
          <a className="text-primary-600 dark:text-primary-400 hover:underline text-sm block mb-3">
            {courseName}
          </a>
        </Link>
        
        {/* 发行Information */}
        <div className="flex items-center mb-3">
          <div className="w-6 h-6 rounded-full overflow-hidden mr-2">
            <Image
              src={issuer.logo}
              alt={issuer.name}
              width={24}
              height={24}
              className="object-cover"
            />
          </div>
          <div className="text-sm text-gray-600 dark:text-gray-400">
            <span>由 </span>
            <span className="font-medium">{issuer.name}</span>
            <span> 颁发于 {formatDate(issueDate)}</span>
          </div>
        </div>
        
        {/* 技能标签 */}
        {skills.length > 0 && (
          <div className="mb-4">
            <div className="text-xs text-gray-500 dark:text-gray-400 mb-1">技能认证:</div>
            <div className="flex flex-wrap gap-1">
              {skills.map((skill, index) => (
                <span 
                  key={index}
                  className="text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full"
                >
                  {skill}
                </span>
              ))}
            </div>
          </div>
        )}
        
        {/* 证书 ID */}
        {tokenId && (
          <div className="text-xs text-gray-500 dark:text-gray-400 mb-4 font-mono">
            Token ID: {tokenId.slice(0, 8)}...{tokenId.slice(-8)}
          </div>
        )}
        
        {/* 操作按钮 */}
        <div className="flex items-center justify-between pt-3 border-t border-gray-100 dark:border-gray-700">
          <div className="flex space-x-3">
            <button
              onClick={handleDownload}
              className="text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white flex items-center"
            >
              <FiDownload className="mr-1" size={14} />
              <span>Download</span>
            </button>
            
            <button
              onClick={handleShare}
              className="text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white flex items-center"
            >
              <FiShare2 className="mr-1" size={14} />
              <span>分享</span>
            </button>
          </div>
          
          {transactionId && (
            <button
              onClick={viewOnBlockchain}
              className="text-xs text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 flex items-center"
            >
              <FiExternalLink className="mr-1" size={14} />
              <span>链上View</span>
            </button>
          )}
        </div>
      </div>
    </div>
  );
};

export default CertificateCard; 